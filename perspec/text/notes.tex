\documentclass{article}

\usepackage{amsmath}

\def\r{\mathbf{r}}
\def\q{\mathbf{q}}
\def\i{\mathbf{i}}
\def\j{\mathbf{j}}
\def\k{\mathbf{k}}


\begin{document}

\section{Coordinate systems}

Let $x,y,z$ be a coordinate system such that the camera is at the
origin, the floor is some known depth below the $x,y$ plane, and
positive $z$ is the current direction of motion of the robot.

We write
\begin{equation}
  \r = x\i + y\j + z\k
\end{equation}
where $\i,\j,\k$ can be considered unit vectors or quaternions.  They
can be conveniently represented as the complex matrices
\begin{equation}
\i = \begin{pmatrix} 0 & i  \\ i & 0  \end{pmatrix} \qquad
\j = \begin{pmatrix} 0 & -1 \\ 1 & 0  \end{pmatrix} \qquad
\k = \begin{pmatrix} i & 0  \\ 0 & -i \end{pmatrix}
\end{equation}
but other representations are also possible.

The camera is at some orientation given by the quaternion $\q$ as
\begin{equation}
\r' = \q \, \r \, \q^*
\end{equation}
Let $z'$ be the forward direction of the camera.

Let $f$ be the focal distance.  Then the camera-plane coordinates will
be
\begin{equation}
  \begin{pmatrix} X' \\ Y' \end{pmatrix} =
  f \begin{pmatrix} x'/z' \\ y'/z' \end{pmatrix}
\end{equation}
The actual camera coordinates will, however, involve a nonlinear
calibration
\begin{equation}
  X,Y = K(X',Y')
\end{equation}

Consider two frames, between which the robot moves by $\Delta z$.
That is, the world coordinate system moves by $-\Delta z$.  This
results in visual vectors
\begin{equation}
  \begin{pmatrix} \Delta X \\ \Delta Y \end{pmatrix}
\end{equation}

\section{Simplest case}

Let us assume that $\q$ and $K$ are identity.  Then
\begin{equation}
   \begin{pmatrix} \Delta X \\ \Delta Y \end{pmatrix} =
-f \begin{pmatrix} X \\ Y \end{pmatrix} \Delta z
\end{equation}




\end{document}
